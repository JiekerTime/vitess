[
  {
    "comment": "select next in subquery",
    "query": "select 1 from t_user where id in (select next value from seq)",
    "plan": "Incorrect usage/placement of 'NEXT'"
  },
  {
    "comment": "two subqueries with different Select and OpCode",
    "query": "select id from t_user where id in (select id from t_user_extra) and col = (select user_id from t_user_extra limit 1)",
    "plan": {
      "QueryType": "SELECT",
      "Original": "select id from t_user where id in (select id from t_user_extra) and col = (select user_id from t_user_extra limit 1)",
      "Instructions": {
        "OperatorType": "Subquery",
        "Variant": "PulloutValue",
        "PulloutVars": [
          "__sq_has_values2",
          "__sq2"
        ],
        "Inputs": [
          {
            "OperatorType": "Limit",
            "Count": "INT64(1)",
            "Inputs": [
              {
                "OperatorType": "TableRoute",
                "Variant": "Scatter-Scatter",
                "Keyspace": {
                  "Name": "user",
                  "Sharded": true
                },
                "FieldQuery": "select user_id from t_user_extra_0 where 1 != 1",
                "Query": "select user_id from t_user_extra limit :__upper_limit",
                "Table": "t_user_extra"
              }
            ]
          },
          {
            "OperatorType": "Subquery",
            "Variant": "PulloutIn",
            "PulloutVars": [
              "__sq_has_values1",
              "__sq1"
            ],
            "Inputs": [
              {
                "OperatorType": "TableRoute",
                "Variant": "Scatter-Scatter",
                "Keyspace": {
                  "Name": "user",
                  "Sharded": true
                },
                "FieldQuery": "select id from t_user_extra_0 where 1 != 1",
                "Query": "select id from t_user_extra",
                "Table": "t_user_extra"
              },
              {
                "OperatorType": "TableRoute",
                "Variant": "IN-Scatter",
                "Keyspace": {
                  "Name": "user",
                  "Sharded": true
                },
                "FieldQuery": "select id from t_user_0 where 1 != 1",
                "Query": "select id from t_user where :__sq_has_values1 = 1 and id in ::__vals and col = :__sq2",
                "Table": "t_user",
                "Values": [
                  "::__sq1"
                ],
                "Vindex": "user_index"
              }
            ]
          }
        ]
      },
      "TablesUsed": [
        "user.t_user",
        "user.t_user_extra"
      ]
    }
  }
]